# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is an OKR (Objectives and Key Results) tracker application built with React 19, TypeScript, and Vite. The entire application is a single-page app contained in `index.tsx` (~1800 lines), using Tailwind CSS for styling via CDN. Data persistence is handled entirely through localStorage.

Originally generated by Google's AI Studio (Gemini), this app is designed for tracking company and departmental objectives with key results, wins logging, and team attribution.

## Development Commands

```bash
# Install dependencies
npm install

# Run development server (localhost:3000)
npm run dev

# Build for production
npm run build

# Preview production build
npm preview
```

## Architecture

### Single-File Application Structure

The entire application lives in `index.tsx` with the following major sections (in order):

1. **Type Definitions** (lines 1-40)
   - `Person`, `WinLog`, `KeyResult`, `Objective` interfaces
   - `KeyResultType`: 'standard' | 'leading' | 'lagging' | 'win_condition'

2. **Default Data** (lines 42-400)
   - `DEFAULT_PEOPLE`: Predefined team members with colors
   - `DEFAULT_DATA`: Sample objectives for Company, Engineering, and Product categories

3. **Component Hierarchy** (lines 400-1620)
   - Icon components (inline SVG)
   - `WinLogger`: Reusable win/achievement logging with people attribution
   - `Modal`: Base modal wrapper
   - `SettingsModal`: Team member management
   - `ObjectiveCard`: Card display for objective list
   - `ObjectiveDetail`: Full objective editor with KR management
   - `DashboardView`: Analytics and progress visualization
   - `WinsFeedView`: Chronological wins feed
   - `OkrsView`: Main OKR list with category filtering

4. **App Component** (lines 1624-1836)
   - Main state management
   - View routing ('dashboard' | 'okrs' | 'wins')
   - localStorage sync
   - Navigation and modal handling

### State Management

All state is managed at the App component level using React hooks:
- `objectives`: Array of Objective objects
- `people`: Array of Person objects
- `view`: Current view mode
- `selectedObjectiveId`: Active objective in review/edit mode
- `activeTab`: Category filter

**Data Persistence:**
- Key: `okr-tracker-data-v3` (objectives)
- Key: `okr-tracker-people` (team members)
- Auto-saves on every change via `useEffect`

### Key Result Types

The app supports four types of Key Results:
- **standard**: Regular numeric targets (e.g., revenue goals)
- **leading**: Forward-looking indicators (e.g., pipeline metrics)
- **lagging**: Trailing indicators (e.g., retention rates)
- **win_condition**: Binary achievements tracked via win logs (e.g., "Make a sale")

Win conditions have special `winLog` arrays that store individual achievement entries with attribution.

### Styling Approach

- Uses Tailwind CSS via CDN (no build step for CSS)
- Dark theme with zinc color palette (zinc-950 background, zinc-200 text)
- Custom scrollbar styling in `index.html`
- Inter font from Google Fonts
- Color coding: violet for primary actions, emerald/blue/violet for people avatars

## Configuration

### Environment Variables

Set `GEMINI_API_KEY` in `.env.local`. The Vite config exposes this as:
- `process.env.API_KEY`
- `process.env.GEMINI_API_KEY`

**Note:** The app currently doesn't use the Gemini API, but the configuration is in place for future AI features.

### Vite Configuration

- Dev server runs on port 3000 with host `0.0.0.0`
- Path alias: `@/` maps to project root
- React plugin enabled with automatic JSX transforms

## TypeScript Configuration

- Target: ES2022
- Module: ESNext with bundler resolution
- Experimental decorators enabled
- JSX: react-jsx (automatic runtime)
- Path alias `@/*` for root imports

## Categories

Hardcoded in App component:
`["All", "Company", "Engineering", "Product", "Marketing", "Sales", "Success"]`

## Adding Features

When modifying the application:

1. **Types First**: Update interfaces at the top if data structure changes
2. **Components Are Co-located**: All components are in `index.tsx` in order of dependency
3. **State Flows Down**: All state lives in `App`, pass callbacks for updates
4. **localStorage Keys**: Changing data structure may require new version key (currently `v3`)
5. **Navigation**: Modal-based navigation for detail views, not routing

## Common Patterns

**Progress Calculation:**
```typescript
const progress = kr.target > 0 ? Math.min((kr.current / kr.target) * 100, 100) : 0;
```

**Win Logging:**
```typescript
onLog={(note, attributedTo, linkedConditionId) => {
  // Creates WinLog entry with attribution
  // If linkedConditionId provided, adds to specific KeyResult
  // Otherwise adds to Objective's wins array
}}
```

**Filtering by Category:**
```typescript
const filtered = activeTab === "All"
  ? objectives
  : objectives.filter(o => o.category === activeTab);
```
